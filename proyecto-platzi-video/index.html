<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Platzi Video</title>
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">
  <link rel="stylesheet" href="src/css/home.css" />
</head>
<body>
  <section class="home">
    <div class="home-sidebar">
      <div class="sidebar">
        <div class="logo">
          <figure class="logo-image">
            <img src="src/images/platzi-video.png" alt="Platzi Video - la Plataforma de videos cheveres"/>
          </figure>
        </div>
        <div class="sidebarPlaylist">
          <h2 class="sidebarPlaylist-title">Mi Playlist <span class="btn warning">Escuchar Playlist</span> </h2>
          <ol class="myPlaylist">
            <li class="myPlaylist-item">
              <a href="#">
                <span>
                  Reasons To Choose A Notebook Over A Computer Desktop
                </span>
              </a>
            </li>
            <li class="myPlaylist-item">
              <a href="#">
                <span>
                  Programming
                </span>
              </a>
            </li>
            <li class="myPlaylist-item">
              <a href="#">
                <span>
                  Pa Bailar
                </span>
              </a>
            </li>
            <li class="myPlaylist-item">
              <a href="#">
                <span>
                  Top 10 mundial
                </span>
              </a>
            </li>
            <li class="myPlaylist-item">
              <a href="#">
                <span>
                  Platzi Video
                </span>
              </a>
            </li>
            <li class="myPlaylist-item">
              <a href="#">
                <span>
                  Luis y sus amigos
                </span>
              </a>
            </li>
            <li class="myPlaylist-item">
              <a href="#">
                <span>
                  Bailar y Bailar
                </span>
              </a>
            </li>
            <li class="myPlaylist-item">
              <a href="#">
                <span>
                  13 reasons why
                </span>
              </a>
            </li>
            <li class="myPlaylist-item">
              <a href="#">
                <span>
                  El mundial
                </span>
              </a>
            </li>
          </ol>
        </div>
        <div class="sidebarPlaylist">
          <h2 class="sidebarPlaylist-title">Playlist de amigos</h2>
          <ul class="playlistFriends">
            <li class="playlistFriends-item">
              <a href="#">
                <img src="src/images/covers/echame-la-culpa.jpg" alt="echame la culpa" />
                <span>
                  Luis Fonsi
                </span>
              </a>
            </li>
            <li class="playlistFriends-item">
              <a href="#">
                <img src="src/images/covers/echame-la-culpa.jpg" alt="echame la culpa" />
                <span>
                  Leonidas Esteban
                </span>
              </a>
            </li>
            <li class="playlistFriends-item">
              <a href="#">
                <img src="src/images/covers/echame-la-culpa.jpg" alt="echame la culpa" />
                <span>
                  Luis Fonsi
                </span>
              </a>
            </li>
            <li class="playlistFriends-item">
              <a href="#">
                <img src="src/images/covers/echame-la-culpa.jpg" alt="echame la culpa" />
                <span>
                  Leonidas Esteban
                </span>
              </a>
            </li>
            <li class="playlistFriends-item">
              <a href="#">
                <img src="src/images/covers/echame-la-culpa.jpg" alt="echame la culpa" />
                <span>
                  Luis Fonsi
                </span>
              </a>
            </li>
            <li class="playlistFriends-item">
              <a href="#">
                <img src="src/images/covers/echame-la-culpa.jpg" alt="echame la culpa" />
                <span>
                  Leonidas Esteban
                </span>
              </a>
            </li>
            <li class="playlistFriends-item">
              <a href="#">
                <img src="src/images/covers/echame-la-culpa.jpg" alt="echame la culpa" />
                <span>
                  Luis Fonsi
                </span>
              </a>
            </li>
            <li class="playlistFriends-item">
              <a href="#">
                <img src="src/images/covers/echame-la-culpa.jpg" alt="echame la culpa" />
                <span>
                  Leonidas Esteban
                </span>
              </a>
            </li>
          </ul>
        </div>
      </div>

    </div>
    <div class="home-primary">
      <!-- <section class="primary"> -->
        <div class="primary-search">
          <form action="" class="search" id="form">
            <input type="text" name="name" placeholder="Buscar un artista o tema favorito"/>
          </form>
        </div>
        <div class="primary-user">
          <div class="user">
            <p>
              <img src="src/images/covers/gorillaz.jpg" alt=""/>
              <span>Leonidas Esteban</span>
            </p>
          </div>
        </div>
        <div class="primary-list">
          <div class="primaryPlaylist">
            <h3 class="primaryPlaylist-topic">A los golpes</h3>
            <h2 class="primaryPlaylist-title">Acción</h2>
            <div class="primaryPlaylist-list" id="action">
            </div>
          </div>
          <div class="primaryPlaylist">
            <h3 class="primaryPlaylist-topic">Para llorar</h3>
            <h2 class="primaryPlaylist-title">Drama</h2>
            <div class="primaryPlaylist-list" id="drama">
            </div>
          </div>
          <div class="primaryPlaylist">
            <h3 class="primaryPlaylist-topic">Dibujitos animados</h3>
            <h2 class="primaryPlaylist-title">Animación</h2>
            <div class="primaryPlaylist-list" id="animation">
            </div>
          </div>
        </div>
      <!-- </section> -->
    </div>
    <div class="home-featuring" id="featuring">

    </div>
  </section>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>
    async function load() {
      async function getData(url) {
        const response = await fetch(url);
        const data = await response.json();
        return data;
      }
      // async function getMovieList() {
      //   const response = await fetch('https://yts.am/api/v2/list_movies.json?genre=action');
      //   const data = await response.json();
      //   return data;
      // }


      function createTemplate(HTMLString) {
        const html = document.implementation.createHTMLDocument();
        html.body.innerHTML = HTMLString;
        return html.body.children[0];
      }

      function videoItemTemplate(data) {
        return (`
          <div class="primaryPlaylistItem">
            <div class="primaryPlaylistItem-image">
              <img src="${data.medium_cover_image}">
            </div>
            <h4 class="primaryPlaylistItem-title">
              ${data.title}
            </h4>
          </div>
        `)
      }

      // const $actionContainer = document.querySelector('#action')


      // actionList.movies.forEach(movie => {
      //   const HTMLString = videoItemTemplate(movie);
      //   const movieElement = createTemplate(HTMLString);
      //   $actionContainer.appendChild(movieElement);
      // })
      //
      function renderMovieList(list, $container) {
        list.movies.forEach(movie => {
          const HTMLString = videoItemTemplate(movie);
          const movieElement = createTemplate(HTMLString);
          $container.appendChild(movieElement);
          movieElement.classList.add('fadeIn')
        })
      }
      const $actionContainer = document.querySelector('#action');
      const $dramaContainer = document.querySelector('#drama');
      const $animationContainer = document.querySelector('#animation');

      const { data: actionList } = await getData('https://yts.am/api/v2/list_movies.json?genre=action');
      const { data: dramaList } = await getData('https://yts.am/api/v2/list_movies.json?genre=drama');
      const { data: animationList } = await getData('https://yts.am/api/v2/list_movies.json?genre=animation');
      renderMovieList(actionList, $actionContainer)
      renderMovieList(dramaList, $dramaContainer)
      renderMovieList(animationList, $animationContainer)
      document.querySelectorAll('.primaryPlaylistItem').forEach((element) => {
        element.addEventListener('click', () => {
          alert(element.querySelector('.primaryPlaylistItem-title').textContent)

        })
      })

      const $featuring = document.querySelector('#featuring');

      function featuringTemplate(data) {
        return (`
          <div class="featuring">
            <div class="featuring-image">
              <img src="${data.medium_cover_image}" width="100" height="100" alt="">
            </div>
            <div class="featuring-content">
              <p class="featuring-title">Continúa viendo</p>
              <p class="featuring-album">${data.title}</p>
            </div>
          </div>
        `)
      }
      const BASE_API = 'https://yts.am/api/v2/'

      // async function getData(url) {
      //   const response = await fetch(url);
      //   const data = await response.json();
      //   return data;
      // }

      $form = document.querySelector('#form');

      $form.addEventListener('submit', async (event) => {
        event.preventDefault();
        const data = new FormData($form);
        const { data: { movies: pelis } } = await getData(`${BASE_API}list_movies.json?limit=1&query_term=${data.get('name')}`);
        const HTMLString = featuringTemplate(pelis[0]);
        // const movieElement = createTemplate(HTMLString);
        $featuring.innerHTML = HTMLString;
      });





    }
    load();

  </script>
</body>
</html>
